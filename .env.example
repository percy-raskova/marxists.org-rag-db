# ============================================================================
# Marxist RAG System - Environment Variables Template
# Version: 0.1.0
# ============================================================================
# Copy this file to .env and fill in the appropriate values
# For parallel development: Copy to .env.instanceX (where X is 1-6)
#
# Project: https://github.com/percy-raskova/marxists.org-rag-db
# Future Home: https://marxism.app
# Author: Persephone Raskova
#
# SECURITY: Never commit files with actual secrets!
# ============================================================================

# ================================
# INSTANCE IDENTITY (Required for all instances)
# ================================
INSTANCE_ID=instance1  # instance1-6
INSTANCE_NAME="Storage & Pipeline"  # Your instance's name
DEVELOPER_EMAIL=developer@example.com

# ================================
# ENVIRONMENT CONFIGURATION
# ================================
ENVIRONMENT=development  # development | staging | production
DEBUG=true
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FORMAT=json  # json | text

# ================================
# GOOGLE CLOUD PLATFORM (All instances need some of these)
# ================================
GOOGLE_PROJECT_ID=mia-rag-project
GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account-key.json
GCP_REGION=us-central1
GCP_ZONE=us-central1-a

# ================================
# STORAGE BUCKETS (Instance 1 primary, others read)
# ================================
GCS_BUCKET_RAW=mia-raw-torrent-dev
GCS_BUCKET_PROCESSED=mia-processed-markdown-dev
GCS_BUCKET_EMBEDDINGS=mia-embeddings-dev
GCS_BUCKET_CHECKPOINTS=mia-checkpoints-dev
GCS_BUCKET_BACKUPS=mia-backups-dev

# Storage lifecycle policies (Instance 1)
ARCHIVE_AFTER_DAYS=30
DELETE_AFTER_DAYS=2555  # 7 years
NEARLINE_AFTER_DAYS=7

# ================================
# INSTANCE 1: STORAGE & PIPELINE
# ================================
# Pipeline configuration
PIPELINE_WORKERS=4
PIPELINE_BATCH_SIZE=1000
PIPELINE_CHECKPOINT_INTERVAL=100

# Storage configuration
STORAGE_CHUNK_SIZE_MB=100
STORAGE_TIMEOUT_SECONDS=300
STORAGE_RETRY_COUNT=3

# Processing configuration
PROCESSING_PARALLEL_WORKERS=4
PROCESSING_MEMORY_LIMIT_GB=16

# ================================
# INSTANCE 2: EMBEDDINGS
# ================================
# Runpod configuration
RUNPOD_API_KEY=your-runpod-api-key-here
RUNPOD_ENDPOINT=https://api.runpod.io/v2
RUNPOD_POD_ID=your-pod-id-here

# Embedding model configuration
EMBEDDING_MODEL=BAAI/bge-large-en-v1.5
EMBEDDING_DIMENSION=1024
EMBEDDING_BATCH_SIZE=1000
EMBEDDING_MAX_SEQUENCE_LENGTH=512

# Processing configuration
EMBEDDINGS_CHECKPOINT_INTERVAL=1000
EMBEDDINGS_MEMORY_LIMIT_GB=32
EMBEDDINGS_USE_AMP=true  # Automatic Mixed Precision
EMBEDDINGS_USE_COMPILE=true  # torch.compile optimization

# Parquet configuration
PARQUET_COMPRESSION=snappy
PARQUET_ROW_GROUP_SIZE=100000
PARQUET_MAX_FILE_SIZE_MB=1000

# ================================
# INSTANCE 3: WEAVIATE VECTOR DB
# ================================
# Weaviate configuration
WEAVIATE_URL=http://weaviate-cluster:8080
WEAVIATE_API_KEY=your-weaviate-api-key-here
WEAVIATE_COLLECTION=marxist_theory_dev
WEAVIATE_SHARDS=3
WEAVIATE_REPLICAS=1

# Import configuration
WEAVIATE_BATCH_SIZE=1000
WEAVIATE_DYNAMIC_BATCH=true
WEAVIATE_TIMEOUT_RETRIES=3
WEAVIATE_CONNECTION_POOL_SIZE=10

# GKE configuration (for deployment)
GKE_CLUSTER_NAME=mia-weaviate-cluster
GKE_NAMESPACE=weaviate
GKE_NODE_COUNT=3
GKE_MACHINE_TYPE=n2-standard-4

# ================================
# INSTANCE 4: QUERY & API
# ================================
# FastAPI configuration
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=true  # Development only
API_CORS_ORIGINS=["http://localhost:3000"]

# Redis cache configuration
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your-redis-password-here
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE_MB=1000

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000

# Query configuration
DEFAULT_RESULT_LIMIT=10
MAX_RESULT_LIMIT=100
QUERY_TIMEOUT_SECONDS=30

# ================================
# INSTANCE 5: MCP INTEGRATION
# ================================
# MCP Server configuration
MCP_SERVER_HOST=0.0.0.0
MCP_SERVER_PORT=8001
MCP_LOG_LEVEL=INFO

# Claude integration
CLAUDE_API_VERSION=v1
MCP_MAX_CONTEXT_SIZE=100000
MCP_RESPONSE_TIMEOUT=60

# Tool configuration
MCP_ENABLE_SEARCH=true
MCP_ENABLE_AUTHOR_LOOKUP=true
MCP_ENABLE_DATE_SEARCH=true
MCP_ENABLE_METADATA=true

# ================================
# INSTANCE 6: MONITORING & TESTING
# ================================
# Prometheus configuration
PROMETHEUS_PORT=9090
PROMETHEUS_SCRAPE_INTERVAL=30
METRICS_PUSH_GATEWAY=http://pushgateway:9091

# Grafana configuration
GRAFANA_PORT=3000
GRAFANA_ADMIN_PASSWORD=your-grafana-password-here
GRAFANA_DASHBOARD_UID=mia-rag-main

# Alerting
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/XXX
ALERT_EMAIL_TO=alerts@example.com
ALERT_EMAIL_FROM=monitoring@example.com

# Testing configuration
TEST_DATA_PATH=/path/to/test/data
TEST_TIMEOUT_SECONDS=300
TEST_PARALLEL_WORKERS=4
INTEGRATION_TEST_ENABLED=false  # Enable in CI only

# ================================
# DATABASE CONFIGURATION (if needed)
# ================================
DATABASE_URL=postgresql://user:password@localhost:5432/mia_rag_dev
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ================================
# SECURITY & AUTHENTICATION
# ================================
SECRET_KEY=your-secret-key-here-use-secrets-manager-in-prod
JWT_SECRET_KEY=your-jwt-secret-here
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# API Key (for service-to-service auth)
API_KEY=your-api-key-here
SERVICE_AUTH_ENABLED=false  # Enable in production

# ================================
# FEATURE FLAGS
# ================================
ENABLE_METRICS=true
ENABLE_TRACING=false
ENABLE_PROFILING=false
ENABLE_DEBUG_ENDPOINTS=true  # Disable in production
ENABLE_CACHE=true
ENABLE_RATE_LIMITING=false  # Enable in production

# ================================
# DEVELOPMENT TOOLS
# ================================
# Hot reload (development only)
WATCHDOG_ENABLED=true

# Mock services (testing only)
USE_MOCK_STORAGE=false
USE_MOCK_EMBEDDINGS=false
USE_MOCK_VECTORDB=false
USE_MOCK_CACHE=false

# ================================
# PERFORMANCE TUNING
# ================================
# Thread pool settings
THREAD_POOL_SIZE=10
ASYNC_WORKERS=4

# Memory limits
MEMORY_LIMIT_MB=16384  # 16GB
MEMORY_WARNING_THRESHOLD=0.8

# Timeout settings
GLOBAL_TIMEOUT_SECONDS=600
REQUEST_TIMEOUT_SECONDS=60
QUERY_TIMEOUT_SECONDS=30

# ================================
# OBSERVABILITY
# ================================
# OpenTelemetry (if using)
OTEL_SERVICE_NAME=mia-rag
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_TRACES_ENABLED=false
OTEL_METRICS_ENABLED=true

# Structured logging
STRUCTURED_LOGGING=true
LOG_CORRELATION_ID=true

# ================================
# PATHS AND DIRECTORIES
# ================================
# Local paths (for development)
LOCAL_DATA_PATH=./data
LOCAL_CHECKPOINT_PATH=./checkpoints
LOCAL_CACHE_PATH=./cache
LOCAL_LOG_PATH=./logs

# ================================
# ADDITIONAL NOTES
# ================================
# 1. In production, use Google Secret Manager or similar for sensitive values
# 2. Different instances need different subsets of these variables
# 3. Some variables are shared (read-only) across instances
# 4. Update values based on your specific instance requirements
# 5. Never commit real credentials or secrets